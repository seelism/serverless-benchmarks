ARG BASE_IMAGE
FROM ${BASE_IMAGE}

RUN apt-get update\
  && apt-get install -y --no-install-recommends zip gosu strace\
  && apt-get purge -y --auto-remove

RUN mkdir -p /sebs/
COPY dockerfiles/nodejs_installer.sh /sebs/installer.sh
COPY dockerfiles/entrypoint.sh /sebs/entrypoint.sh
RUN chmod +x /sebs/entrypoint.sh

# useradd and groupmod is installed in /usr/sbin which is not in PATH
ENV SCRIPT_FILE=/mnt/function/package.sh
CMD /bin/bash /sebs/installer.sh
ENTRYPOINT ["strace", "-f", "-Co", "/logs/stracebuild.log", "/sebs/entrypoint.sh"]
